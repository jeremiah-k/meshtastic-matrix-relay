# Ralphy Configuration
# https://github.com/michaelshimeles/ralphy

# Project info (auto-detected, edit if needed)
project:
  name: "meshtastic-matrix-relay"
  language: "Python"
  framework: ""
  description: "Relay for Meshtastic <-> Matrix messaging"

# Commands (auto-detected from package.json/pyproject.toml)
commands:
  test: "python -m pytest -v --cov --tb=short"
  lint: ".trunk/trunk check --fix --all"
  typecheck: "python -m mypy src/ --strict"
  build: ""

# Rules - instructions the AI MUST follow
# These are injected into every prompt
rules:
  - "Use isort with black profile for imports (already configured)"
  - "Use Black formatter with 88-character line length"
  - "Use type hints consistently (Python 3.10+)"
  - "Use snake_case for functions/variables, PascalCase for classes"
  - "Use specific exceptions, avoid bare except clauses"
  - "Use structured logging via log_utils.get_logger()"
  - "Use asyncio patterns, avoid sync calls in async contexts"
  - "Use asyncio.to_thread() for running blocking operations in async context"
  - "Test with pytest with async support, mark tests appropriately"
  - "Treat all warnings as errors - fix underlying issues, don't suppress"
  - "Use regular Mock with return_value for functions called via asyncio.run(), not AsyncMock"
  - "When testing async functions that call asyncio.run(), use mock.return_value instead of AsyncMock"
  - "Follow Arrange-Act-Assert pattern in tests with descriptive test names"
  - "Do NOT add comments unless asked"

# Boundaries - files/folders the AI should not modify
boundaries:
  never_touch:
    - "venv/**"
    - ".venv/**"
    - "*.pyc"
    - "__pycache__/**"
    - ".pytest_cache/**"
    - "*.egg-info/**"
    - "htmlcov/**"
    - ".mypy_cache/**"
    - ".ruff_cache/**"
